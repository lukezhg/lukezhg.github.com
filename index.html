
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Chunlei's Blog</title>
  <meta name="author" content="chunlei">

  
  <meta name="description" content="1、通过创建一个新的 virtualenv 为部署 Django 应用程序设置环境： mkvirtualenv DjangoApp 要退出新的 virtualenv，请使用 deactivate。您可以使用 workon 在环境之间切换。要加载或在 virtualenv 之间切换，请使用 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://zhangchunlei.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <link href="/stylesheets/mermaid.css" rel="stylesheet" type="text/css">

  <link href="/atom.xml" rel="alternate" title="Chunlei's Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Chunlei's Blog</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com.hk/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:zhangchunlei.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/"> Home </a></li>
  <li><a href="/about"> About </a></li>
  <li><a href="/blog/archives">Blog</a></li>
  <li><a href="/course"> Course </a></li>
  <li><a href="/app"> App </a></li>
  <li><a href="/cn"> 中文 </a></li>
  <li><a href="/en"> English </a></li>
  <li><a href="/log"> log </a></li>
</ul>
</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/12/31/django-cheat-sheet/">Django Cheat Sheet</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-12-31T09:50:00+08:00" pubdate data-updated="true">Dec 31<span>st</span>, 2017</time>
        
         | <a href="/blog/2017/12/31/django-cheat-sheet/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>1、通过创建一个新的 virtualenv 为部署 Django 应用程序设置环境：</p>

<pre><code>mkvirtualenv DjangoApp
</code></pre>

<p>要退出新的 virtualenv，请使用 deactivate。您可以使用 workon 在环境之间切换。要加载或在 virtualenv 之间切换，请使用 workon 命令：</p>

<pre><code>workon DjangoApp
</code></pre>

<p>在您的当前环境中安装 Django</p>

<pre><code>pip install Django
</code></pre>

<p>2、使用 django-admin 命令创建项目</p>

<pre><code>django-admin startproject demoproject
</code></pre>

<p>3、进入demo project文件夹，使用python manage.py startapp 创建应用.</p>

<pre><code>cd demoproject
python manage.py startapp demoapp
</code></pre>

<p>4、测试项目服务器，Ctrl+C退出服务器。</p>

<pre><code>python manage.py runserver
</code></pre>

<p>或者指定服务器ip和端口。</p>

<pre><code>python manage.py runserver 0.0.0.0:8000
</code></pre>

<p>5、创建超级用户用于登陆django admin后台管理平台。</p>

<pre><code>python manage.py createsuperuser admin
</code></pre>

<p>6、编辑设置文件和项目相关文件。  <br/>
settings.py 控制项目参数。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>INSTALLED_APPS = [
</span><span class='line'>    'django.contrib.admin',
</span><span class='line'>    'django.contrib.auth',
</span><span class='line'>    'django.contrib.contenttypes',
</span><span class='line'>    'django.contrib.sessions',
</span><span class='line'>    'django.contrib.messages',
</span><span class='line'>    'django.contrib.staticfiles',
</span><span class='line'>    'clips',
</span><span class='line'>]
</span><span class='line'>
</span><span class='line'>DATABASES = {
</span><span class='line'>    'default': {
</span><span class='line'>        'ENGINE': 'django.db.backends.mysql',#mysql.connector.django
</span><span class='line'>        'USER': 'root',
</span><span class='line'>        'PASSWORD': '123456',
</span><span class='line'>        'NAME': 'demoproject',
</span><span class='line'>        'HOST': '127.0.0.1',
</span><span class='line'>        'PORT': '3306',
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>urls.py 控制访问请求路径</p>

<pre><code>from django.conf.urls import url
from django.contrib import admin
from demoproject.views import hello
urlpatterns = [
    url(r'^admin/', admin.site.urls),
    url(r'^hello/$', hello),
]
</code></pre>

<p>views.py 控制访问请求的应答</p>

<pre><code>from django.http import HttpResponse
def hello(request):
    return HttpResponse("Hello world")
</code></pre>

<p>demoapp/models.py 控制数据结构（表格、变量、变量属性）</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>from __future__ import unicode_literals
</span><span class='line'>from django.db import models
</span><span class='line'>
</span><span class='line'>class User(models.Model):
</span><span class='line'>    user_name = models.CharField(max_length=30)
</span><span class='line'>    password = models.CharField(max_length=40)
</span><span class='line'>    email = models.EmailField()
</span><span class='line'>    headshot = models.ImageField(upload_to='headshot',null=True,blank=True)
</span><span class='line'>    brief = models.CharField(max_length=100)
</span><span class='line'>    join_date = models.DateField()
</span><span class='line'>    user_star = models.CharField(max_length=30)
</span><span class='line'>    def __unicode__(self):
</span><span class='line'>        return self.user_name
</span><span class='line'>......</span></code></pre></td></tr></table></div></figure>


<p>demoapp/admin.py 控制后台注册和数据呈现</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>from __future__ import unicode_literals
</span><span class='line'>from django.contrib import admin
</span><span class='line'>from .models import User, Clip, Link
</span><span class='line'>import sys;  
</span><span class='line'>reload(sys);  
</span><span class='line'>sys.setdefaultencoding("utf8")
</span><span class='line'>
</span><span class='line'>class UserAdmin(admin.ModelAdmin):
</span><span class='line'>    list_display = ('user_name', 'password', 'email')
</span><span class='line'>    search_fields = ('user_name', 'email')
</span><span class='line'>......
</span><span class='line'>admin.site.register(User,UserAdmin)
</span><span class='line'>......</span></code></pre></td></tr></table></div></figure>


<p>7、当你修改models.py时，需要通过makemigrations将修改反应到数据库中去。</p>

<pre><code>python manage.py makemigrations
python manage.py migrate
</code></pre>

<p>8、利用template来呈现页面。</p>

<p>首先要修改settings.py</p>

<pre><code>TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [os.path.join(BASE_DIR,'templates')],
        'APP_DIRS': True,
        'OPTIONS': {
            # ...
</code></pre>

<p>接下来建文件夹templates</p>

<pre><code>\demoproject
    \demoproject
    \demoapp
    \templates
    manage.py
</code></pre>

<p>修改demoproject\views.py</p>

<pre><code>from django.shortcuts import render
import datetime
def current_datetime(request):
    now = datetime.datetime.now()
    return render(request, 'current_datetime.html', {'current_date': now})
</code></pre>

<p>在templates文件夹，新建html模版文件current_datetime.html。</p>

<p>\mysite_project\mysite\templates\current_datetime.html</p>

<pre><code>&lt;html&gt;
    &lt;body&gt;
        It is now {{ current_date }}
    &lt;/body&gt;
&lt;/html&gt;
It is now {{ current_date }}.
</code></pre>

<p>模版的继承，比如我们建一个地层模版，然后在这个模版的基础上加载子模版，这样就可以避免重复。<br/>
参考：https://djangobook.com/templates-in-views/</p>

<p>base.html</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot;&gt;</span>
</span><span class='line'><span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>    <span class="nt">&lt;title&gt;</span>{% block title %}{% endblock %}<span class="nt">&lt;/title&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h1&gt;</span>My helpful timestamp site<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>    {% block content %}{% endblock %}
</span><span class='line'>    {% block footer %}
</span><span class='line'>    <span class="nt">&lt;hr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;p&gt;</span>Thanks for visiting my site.<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>    {% endblock %}
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>current_datetime.html</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>{% extends &quot;base.html&quot; %}
</span><span class='line'>{% block title %}The current time{% endblock %}
</span><span class='line'>{% block content %}
</span><span class='line'>    <span class="nt">&lt;p&gt;</span>It is now {{ current_date }}.<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>{% endblock %}
</span></code></pre></td></tr></table></div></figure>


<p>hours_ahead.html</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>{% extends &quot;base.html&quot; %}
</span><span class='line'>{% block title %}Future time{% endblock %}
</span><span class='line'>{% block content %}
</span><span class='line'><span class="nt">&lt;p&gt;</span>
</span><span class='line'>    In {{ hour_offset }} hour(s), it will be {{ next_time }}.
</span><span class='line'><span class="nt">&lt;/p&gt;</span>
</span><span class='line'>{% endblock %}
</span></code></pre></td></tr></table></div></figure>


<p>9、利用form来获取用户数据。</p>

<p>mysite_project\mysite\books\templates\books\search_form.html</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>    <span class="nt">&lt;title&gt;</span>Search<span class="nt">&lt;/title&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;/search/&quot;</span> <span class="na">method=</span><span class="s">&quot;get&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;q&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Search&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/form&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>mysite\books\urls.py</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">books</span> <span class="kn">import</span> <span class="n">views</span>
</span><span class='line'><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'>    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^search-form/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">search_form</span><span class="p">),</span>
</span><span class='line'>    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^search/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">search</span><span class="p">),</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>mysite\urls.py</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>
</span><span class='line'><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'><span class="c"># ...</span>
</span><span class='line'>    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">&#39;books.urls&#39;</span><span class="p">)),</span>
</span><span class='line'><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>books\views.py</p>

<pre><code>from django.shortcuts import render
def search_form(request):
    return render(request, 'books/search_form.html')
def search(request):
    if 'q' in request.GET:
        message = 'You searched for: %r' % request.GET['q']
    else:
        message = 'You submitted an empty form.'
    return HttpResponse(message)
</code></pre>

<p>参考：https://djangobook.com/django-forms/</p>

<p>定义表单类，更简洁的获取用户数据的方法。</p>

<p>mysite_project\mysite\mysite\forms.py</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
</span><span class='line'><span class="k">class</span> <span class="nc">ContactForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
</span><span class='line'>    <span class="n">subject</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">()</span>
</span><span class='line'>    <span class="n">email</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</span><span class='line'>    <span class="n">message</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>mysite_project\mysite\mysite\views.py</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">Http404</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">,</span> <span class="n">HttpResponseRedirect</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">datetime</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">mysite.forms</span> <span class="kn">import</span> <span class="n">ContactForm</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">django.core.mail</span> <span class="kn">import</span> <span class="n">send_mail</span><span class="p">,</span> <span class="n">get_connection</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">contact</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">&#39;POST&#39;</span><span class="p">:</span>
</span><span class='line'>        <span class="n">form</span> <span class="o">=</span> <span class="n">ContactForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
</span><span class='line'>            <span class="n">cd</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span>
</span><span class='line'>            <span class="n">con</span> <span class="o">=</span> <span class="n">get_connection</span><span class="p">(</span><span class="s">&#39;django.core.mail.backends.console.EmailBackend&#39;</span><span class="p">)</span>
</span><span class='line'>            <span class="n">send_mail</span><span class="p">(</span>
</span><span class='line'>                <span class="n">cd</span><span class="p">[</span><span class="s">&#39;subject&#39;</span><span class="p">],</span>
</span><span class='line'>                <span class="n">cd</span><span class="p">[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
</span><span class='line'>                <span class="n">cd</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;email&#39;</span><span class="p">,</span> <span class="s">&#39;noreply@example.com&#39;</span><span class="p">),</span>
</span><span class='line'>                <span class="p">[</span><span class="s">&#39;siteowner@example.com&#39;</span><span class="p">],</span>
</span><span class='line'>                <span class="n">connection</span><span class="o">=</span><span class="n">con</span>
</span><span class='line'>            <span class="p">)</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="s">&#39;/contact/thanks/&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">else</span><span class="p">:</span>
</span><span class='line'>        <span class="n">form</span> <span class="o">=</span> <span class="n">ContactForm</span><span class="p">()</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">&#39;contact_form.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;form&#39;</span><span class="p">:</span> <span class="n">form</span><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>mysite_project\mysite\templates\contact_form.html</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>    <span class="nt">&lt;title&gt;</span>Contact us<span class="nt">&lt;/title&gt;</span>
</span><span class='line'>    <span class="nt">&lt;style </span><span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">ul</span><span class="nc">.errorlist</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>            <span class="k">padding</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="nc">.errorlist</span> <span class="nt">li</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">background-color</span><span class="o">:</span> <span class="nb">red</span><span class="p">;</span>
</span><span class='line'>            <span class="k">color</span><span class="o">:</span> <span class="nb">white</span><span class="p">;</span>
</span><span class='line'>            <span class="k">display</span><span class="o">:</span> <span class="k">block</span><span class="p">;</span>
</span><span class='line'>            <span class="k">font-size</span><span class="o">:</span> <span class="m">1.2em</span><span class="p">;</span>
</span><span class='line'>            <span class="k">margin</span><span class="o">:</span> <span class="m">0</span> <span class="m">0</span> <span class="m">3px</span><span class="p">;</span>
</span><span class='line'>            <span class="k">padding</span><span class="o">:</span> <span class="m">4px</span> <span class="m">5px</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="nt">&lt;/style&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>    <span class="nt">&lt;h1&gt;</span>Contact us<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>    {% if form.errors %}
</span><span class='line'>        <span class="nt">&lt;p</span> <span class="na">style=</span><span class="s">&quot;color: red;&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            Please correct the error{{ form.errors|pluralize }} below.
</span><span class='line'>        <span class="nt">&lt;/p&gt;</span>
</span><span class='line'>    {% endif %}
</span><span class='line'>    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">novalidate</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;table&gt;</span>
</span><span class='line'>            {{ form.as_table }}
</span><span class='line'>        <span class="nt">&lt;/table&gt;</span>
</span><span class='line'>        {% csrf_token %}
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Submit&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/form&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>10、urls进阶</p>

<p>\urls.py</p>

<pre><code>from django.conf.urls import include, url
from . import views
urlpatterns = [
    url(r'^hello/$', views.hello),
    url(r'^time/$', views.current_datetime),
          url(r'^time/plus/(d{1,2})/$', views.hours_ahead),
]
</code></pre>

<p>\urls.py</p>

<pre><code>from django.conf import settings
from django.conf.urls import url
from . import views
urlpatterns = [
    url(r'^$', views.homepage),
    url(r'^(\d{4})/([a-z]{3})/$', views.archive_month),
]
if settings.DEBUG:
    urlpatterns += [url(r'^debuginfo/$', views.debug),]
</code></pre>

<p>\urls.py</p>

<pre><code>from django.conf.urls import url
from . import views
urlpatterns = [
    url(r'^reviews/2003/$', views.special_case_2003),
    url(r'^reviews/([0-9]{4})/$', views.year_archive),
    url(r'^reviews/([0-9]{4})/([0-9]{2})/$', views.month_archive),
    url(r'^reviews/([0-9]{4})/([0-9]{2})/([0-9]+)/$', views.review_detail),
]
</code></pre>

<p>更多参考： https://djangobook.com/advanced-views-urlconfs/</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/12/30/mysql-charset-admin-django/">Mysql Charset Admin Django</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-12-30T22:37:00+08:00" pubdate data-updated="true">Dec 30<span>th</span>, 2017</time>
        
         | <a href="/blog/2017/12/30/mysql-charset-admin-django/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>中文乱码永远是程序猿的痛！！</p>

<p>今天使用django-admin就遇到了乱码问题，是仿照<a href="https://djangobook.com/adding-models-to-django-admin/">django book</a>的model用法，做一个资源管理平台出现的问题。</p>

<p>代码提示：mysql不能正确处理中文字符，于是一路google找到几个可能的解决措施：</p>

<p>1、修改admin.py</p>

<pre><code>import sys;   
reload(sys);  
sys.setdefaultencoding("utf8") 
</code></pre>

<p>这个办法曾经帮助我解决了chatbot项目的乱码问题。</p>

<p>2、修改mysql的配置文件/etc/my.cnf<br/>
方案一：</p>

<pre><code>[mysqld]
character-set-server=utf8 
[client]
default-character-set=utf8 
[mysql]
default-character-set=utf8
</code></pre>

<p>方案二：utf8mb4兼容utf8，且比utf8能表示更多的字符，是utf8字符集的超集。所以现在一些新的业务，比如ISO等，会将MySQL数据库的字符集设置为utf8mb4。</p>

<pre><code>[client]  
default-character-set=utf8mb4  

[mysqld]  
character-set-server = utf8mb4  
collation-server = utf8mb4_unicode_ci  
init_connect='SET NAMES utf8mb4'  
skip-character-set-client-handshake = true  

[mysql]  
default-character-set = utf8mb4  
</code></pre>

<p>3、关键还是要会使用命令诊断问题所在。<br/>
我的问题出在新建的数据库中表单变量的字符码设置不是utf8，后来把数据库drop掉，重新配置my.cnf文件，然后重建mysql数据库就没问题了。</p>

<p>4、常用的mysql命令和django命令。</p>

<pre><code>mysql -u db_user -p
SHOW DATABASES;
CREATE DATABASE blog_data;
drop database mydb;
SHOW DATABASES;
</code></pre>

<p>CTRL + D退出mysql。</p>

<p>通过show variables 命令查看字符编码，发现部分变量的编码果然不是utf8，难怪乱码。</p>

<pre><code>show variables like '%char%’;
</code></pre>

<p>尝试重制响应的字符编码设置。</p>

<pre><code>set character_set_server=utf8;
set character_set_database=utf8;
show variables like '%char%’;
</code></pre>

<p>结果无效，于是进一步查看响应的数据库及其表单：</p>

<pre><code>use my_db;
show tables;
show full columns from table1; ／／这条命令可以看到table1中的变量情况，发现果然编码有问题。 
</code></pre>

<p>尝试修改这个表单中的变量设置,也就是my_db.table1表单中的my_var变量字符编码。</p>

<pre><code>ALTER TABLE my_db.table1 MODIFY COLUMN my_var VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;
</code></pre>

<p>错误代码位置发生了改变，这说明改动有效，于是重新建立数据库（见3）。</p>

<p>5、Django的一些命令。</p>

<pre><code>python manage.py createsuperuser #生成admin登陆的超级用户和密码
python manage.py makemigrations #当更改model时，通过此命令把变动反应到数据库中
python manage.py migrate
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/12/29/swf-send-data-to-java-script/">Swf Send Data to Java Script</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-12-29T19:21:00+08:00" pubdate data-updated="true">Dec 29<span>th</span>, 2017</time>
        
         | <a href="/blog/2017/12/29/swf-send-data-to-java-script/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Flash制作动画非常便捷，但是如何能够把用swf文件收集的数据发送給JS处理呢？下面是一个简单的例子：<br/>
1、首先在html网页中通过object嵌入swf文件</p>

<pre>
<code>
    <body>
    <object type="application/x-shockwave-flash" data="{% static "flash/test.swf" %}"  name="test" width="550" height="400">
    <param name="allowScriptAccess" value="sameDomain" /> 
    <param name="movie" value="{% static "flash/test.swf" %}" />
    </object>
    </body>
</code>
</pre>


<p>2、在网页的头部嵌入要调用的函数hello</p>

<pre>
<code>
    <script>
        function hello(v){ 
            alert("hello: "+v);
            document.location.href = '/search';
        } 
        function thisMovie(movieName) { 
            if (navigator.appName.indexOf("Microsoft") != -1) { 
                return window[movieName] 
            } 
            else { 
                return document[movieName] 
            } 
        }
    </script>
</code>
</pre>


<p>3、编辑fla文件，建立一个文本框txt1和一个提交submit按钮</p>

<pre>
<code>

    package {
    import flash.net.*;
    import flash.events.Event;
    import flash.events.MouseEvent;
    import flash.display.MovieClip;
    import flash.external.ExternalInterface; 
    public class test extends MovieClip {
        public function test(): void {
            submit.addEventListener(MouseEvent.CLICK, postForm);
        }
        private function postForm(evt: MouseEvent): void {
            ExternalInterface.call("hello", txt1.text); 
        }
    }
</code>
</pre>


<p>4、实现的效果如下：<br/>
当你点击submit按钮时，swf文件会将txt1.text传递給hello函数，并且通过JS现实对话框“欢迎： 某某” 并且跳转到／search页面。</p>

<p>5、原理解释<br/>
fla文件中，导入了flash.external.ExternalInterface类，它是专门负责外部通信的。通过ExternalInterface.call方法，就可以调用object容器外部的函数hello。</p>

<p>6、JS调用AS函数的实现方法。<br/>
上面实现了AS调用JS并传递参数，那么反过来，JS是否可以调用AS函数呢？答案是肯定的。</p>

<p>AS类这样写：</p>

<pre>
<code>
    package {
        import flash.net.*;
        import flash.events.Event;
        import flash.events.MouseEvent;
        import flash.display.MovieClip;
        import flash.external.ExternalInterface;
        
        public class test extends MovieClip {
            public function test(): void {
                submit.addEventListener(MouseEvent.CLICK, postForm);
                ExternalInterface.addCallback("say", say); //regist 
            }
            
            private function say(txt: String) {
                txt2.text = txt;
            }
            
            private function postForm(evt: MouseEvent): void {
                //call js function
                ExternalInterface.call("hello", txt1.text);
            }
        }
    }
</code>
</pre>


<p>Html这样写：</p>

<pre>
<code>

    <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
    <html lang="en">
    <head>
        <title>As communicate with JS</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script>
            function hello(v){ 
                alert("hello: "+v);
                //document.location.href = '/search';
            }
            function thisMovie(movieName) { 
                if (navigator.appName.indexOf("Microsoft") != -1) { 
                    return window[movieName] 
                } 
                else { 
                    return document[movieName] 
                } 
            }
            $(document).ready(function(){
                $("#btn1").click(function(){
                    $("#test1").text("Hello world!");
                });
                $("#btn2").click(function(){
                    $("#test2").html("<b>Hello world!</b>");
                });
                $("#btn3").click(function(){
                    //$("#test3").val("Dolly Duck");
                    var txt=$("#test3").val();
                    thisMovie("test").say(txt);
                });
            });
        </script>
    </head>
    <body>
        <object type="application/x-shockwave-flash" data="{% static "flash/test.swf" %}"  name="test" width="550" height="400">
        <param name="allowScriptAccess" value="sameDomain" /> 
        <param name="movie" value="{% static "flash/test.swf" %}" />
        <embed src="{% static "flash/test.swf" %}" name="test" quality="high" allowScriptAccess="always" swLiveConnect="true" type="application/x-shockwave-flash" width="550" height="400"></embed>
        </object>
        <br>
        <p id="test1">This is a paragraph.</p>
        <p id="test2">This is another paragraph.</p>
        <p>Input field: <input type="text" id="test3" value="Mickey Mouse"></p>
        <button id="btn1">Set Text</button>
        <button id="btn2">Set HTML</button>
        <button id="btn3">Set Value</button>
    </body>
    </html>

</code>
</pre>


<p>7、遗留的问题：这样的写法谷歌浏览器没问题，但是火狐浏览器不成功，也就是不能把参数传到swf上。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/12/18/the-writing-tips-of-the-story-coco/">《寻梦环游记》的故事元素</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-12-18T10:34:00+08:00" pubdate data-updated="true">Dec 18<span>th</span>, 2017</time>
        
         | <a href="/blog/2017/12/18/the-writing-tips-of-the-story-coco/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>皮克斯制作的动画比如《玩具总动员》，《汽车总动员》，《头脑特工队》都深受观众喜爱。这次又出了新作《寻梦环游记》不仅获得了很高的票房，而且也得到了观众和影评人的一致好评。皮克斯成功的秘诀是什么呢？公司老总给出的答案是：故事、故事还是故事。</p>

<p>郝广才曾经在得到直播专分享过英雄故事的写作元素。</p>

<pre><code>郝广才说，最动人的故事一定是和英雄有关的。
掌握了英雄故事的结构，就能写好一个动人的故事。
英雄故事的结构就像一个钟表盘上的12个刻度，
分别是得到召唤，请求智者支援，启程迎接挑战，开始面对困难的试炼，然后面临恐惧，遭遇危机，接着得到宝物，解决问题，荣归故里，重获新生，获得领悟，最后舍弃功与名回到现实。
</code></pre>

<p>让我们看一看，《寻梦环游记》这部动画的故事情节是否能跟这12个刻度有一定的呼应。</p>

<p>发生：男孩喜欢音乐，梦想向歌王一样歌唱和演奏，但是他却生活在一个极度讨厌音乐的鞋匠世家。他听到镇上有一个才艺秀表演打算参加。【得到召唤】</p>

<p>活动和阻碍：男孩想听、想唱、想演奏，但是都被家人阻挠。他偷偷制造的吉他，结果被意外发现，也被祖母摔个稀巴烂。【面对阻挠】</p>

<p>发展：他一气之下逃离了家庭，准备追寻自己的梦想。为了参加比赛，他需要一把吉他，但是他借不到吉他。一个想法钻进他的脑子里，他想把歌王的吉他借出来演奏。【得到灵感】【启程迎接挑战】</p>

<p>转折：在祭奠歌王的宫殿，他拿到了吉他，但是却因为被诅咒而变成了亡灵。他来到了死人的世界。他遇到了自己家族中先去的亲人，并且见到了他的曾祖母。曾祖母可以通过一个祝福让他回到真实世界，但是却限制他玩音乐。【面对阻挠和危机】</p>

<p>转折：他回到现实世界，结果拿上吉他想去参加比赛，结果违背了条件，又回到了亡灵世界。他终于认识到自己真正的梦想是音乐，为了实现这个梦想，他必须找到并得到曾祖父的祝福，于是就和一个偶然遇到的亡魂开始寻找歌王之旅。曾祖母则开始追踪和保护小男孩。【获得领悟】</p>

<p>转折：找到了歌王之后，他发现歌王实际上并不是他的曾祖父，而是害死自己曾祖父的人。路上偶遇的亡灵才是自己的曾祖父。他的曾祖父实际上是被歌王用毒酒害死的。曾祖父也并没有为了音乐而抛弃家庭，而是深爱着可可，也就是小孩祖母的妈妈。【遭遇危机】</p>

<p>转折：他意识到了家庭的重要性，并愿意向曾祖父那样以家庭为重，甚至放弃音乐。【获得领悟】</p>

<p>转折：经过一番搏斗，歌王被打败了，作品剽窃和杀人的丑事也被知道了。可是曾祖父因为可可马上就忘记他了，而就要消失了。曾祖母給了小男孩祝福，并且没有附加任何条件。【面临危机】</p>

<p>结尾：小男孩会到现实世界，他用吉他演奏了曾祖父的歌曲，可可恢复了记忆，讲述了以往的故事，转变了家人对音乐的看法。一家人又再次相互理解和包容起来，最后在小男孩的歌声和舞蹈里，故事结尾。【回归现实】【重获新生】【获得领悟】</p>

<p>虽然这部动画片不算是典型的战争英雄故事，比如《勇敢的心》，但是小主人公在现实世界和亡灵界追寻梦想、挑战自我、战胜困难、发现自我、获得领悟的历程所展现的，就是他成为自己生活英雄的过程。而这样的生活英雄跟容易与孩子和成人产生共鸣！</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/12/15/ajax-and-chatbot/">AJAX and Chatbot</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-12-15T20:14:00+08:00" pubdate data-updated="true">Dec 15<span>th</span>, 2017</time>
        
         | <a href="/blog/2017/12/15/ajax-and-chatbot/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>AJAX是一个缩写，代表：Asynchronous JavaScript And XML.</p>

<pre><code>AJAX is a developer's dream, because you can:
# Read data from a web server - after the page has loaded
# Update a web page without reloading the page
# Send data to a web server - in the background
</code></pre>

<p>今天改写了一个代码实现了聊天的过程中不需要重新加载页面。代码如下：</p>

<p>urls.py</p>

<pre><code>url(r'^api/chat/', post), 
</code></pre>

<p>view.py</p>

<pre><code>def post(request, *args, **kwargs):
    """
    Return a response to the statement in the posted data.
    """
    bot = ChatBot("Training Example")
    bot.set_trainer(ListTrainer)
    input_data = json.loads(request.read().decode('utf-8'))
    response = bot.get_response(input_data)
    response_data = response.serialize()
    return JsonResponse(response_data, status=200)
</code></pre>

<p>chat.html</p>

<pre><code>&lt;script&gt;
  var chatterbotUrl = '/api/chat/';
  var csrftoken = Cookies.get('csrftoken');
  function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
  }

  $.ajaxSetup({
    beforeSend: function(xhr, settings) {
      if (!csrfSafeMethod(settings.type) &amp;&amp; !this.crossDomain) {
        xhr.setRequestHeader("X-CSRFToken", csrftoken);
      }
    }
  });

  var $input = $('#input');
  var $sayButton = $('#sayButton');
  var $answer = $('#answer');

  function submitInput() {
    var inputData = {
      'text': $input.val()
    }
    var $submit = $.ajax({
      type: 'POST',
      url: chatterbotUrl,
      data: JSON.stringify(inputData),
      contentType: 'application/json'
    });

    $submit.done(function(statement) {
        $answer.val(statement.text);
        // Clear the input field
        $input.val('');
        //alert(statement.text)
    });

  $sayButton.click(function() {
    submitInput();
  });
</code></pre>

<p>原理是这样的，首先你需要通过urls.py文件指定在请求特定url的时候，触发的函数。这个函数是在view.py中定义的，也就是post函数。post函数需要至少一个参数，也就是request，request必须包含一个text的属性才能被read()出来而不出错。之后，post函数会返回一个JsonResponse，其中机器人的回答可以通过statement.text来获取和使用，见chat.html中的$submit.done函数。</p>

<p>当不知道传递的是何值时，可以通过html 中的alert或者python中的print（）来监听调试。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p><img src="https://raw.github.com/lukezhg/Freyja/master/chunlei.png" alt="chunlei" /></p>
  <p>慧行坚勇 <a href="http://zhangchunlei.com/about/">More</a> <a href="http://zhangchunlei.com/blog/categories/%E6%95%99%E5%AD%A6/">教学</a> <a href="http://zhangchunlei.com/blog/categories/%E7%A7%91%E7%A0%94/">科研</a> <a href="http://www.skc.ecnu.edu.cn/">skc</a> </p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/12/31/django-cheat-sheet/">Django cheat sheet</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/12/30/mysql-charset-admin-django/">mysql charset admin django</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/12/29/swf-send-data-to-java-script/">Swf send data to Java Script</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/12/18/the-writing-tips-of-the-story-coco/">《寻梦环游记》的故事元素</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/12/15/ajax-and-chatbot/">AJAX and Chatbot</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/27/how-to-run-js-node-and-appche/">How to run JS node and appche</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/13/super-city-and-abc/">超级城市与潜在的机会</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/12/science-theater/">Science Theater</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/10/use-mermaid-to-render-graph/">Use mermaid to render Graph</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/04/stem-and-love/">STEM &amp; Love</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/book'>book (5)</a></li><li><a href='/blog/categories/code'>code (1)</a></li><li><a href='/blog/categories/computer'>computer (4)</a></li><li><a href='/blog/categories/courses'>courses (7)</a></li><li><a href='/blog/categories/firefox'>Firefox (4)</a></li><li><a href='/blog/categories/flash'>flash (4)</a></li><li><a href='/blog/categories/github'>github (3)</a></li><li><a href='/blog/categories/irt'>IRT (3)</a></li><li><a href='/blog/categories/machine-learning'>machine learning (1)</a></li><li><a href='/blog/categories/meeting'>meeting (3)</a></li><li><a href='/blog/categories/octopress'>octopress (1)</a></li><li><a href='/blog/categories/opencourse'>opencourse (4)</a></li><li><a href='/blog/categories/openlearning'>openlearning (4)</a></li><li><a href='/blog/categories/pck'>pck (5)</a></li><li><a href='/blog/categories/resources'>resources (1)</a></li><li><a href='/blog/categories/supervision'>supervision (5)</a></li><li><a href='/blog/categories/ubuntu'>Ubuntu (7)</a></li><li><a href='/blog/categories/web2-0'>web2.0 (4)</a></li><li><a href='/blog/categories/webdev'>webdev (1)</a></li><li><a href='/blog/categories/writing'>writing (1)</a></li><li><a href='/blog/categories/书信'>书信 (1)</a></li><li><a href='/blog/categories/会议'>会议 (4)</a></li><li><a href='/blog/categories/健康'>健康 (1)</a></li><li><a href='/blog/categories/写作'>写作 (1)</a></li><li><a href='/blog/categories/反思'>反思 (8)</a></li><li><a href='/blog/categories/学习环境'>学习环境 (1)</a></li><li><a href='/blog/categories/学习社区'>学习社区 (2)</a></li><li><a href='/blog/categories/宝宝'>宝宝 (3)</a></li><li><a href='/blog/categories/家庭教育'>家庭教育 (5)</a></li><li><a href='/blog/categories/对话'>对话 (3)</a></li><li><a href='/blog/categories/工作'>工作 (1)</a></li><li><a href='/blog/categories/技术技巧'>技术技巧 (17)</a></li><li><a href='/blog/categories/搜索引擎'>搜索引擎 (4)</a></li><li><a href='/blog/categories/撰写中'>撰写中 (1)</a></li><li><a href='/blog/categories/教学'>教学 (50)</a></li><li><a href='/blog/categories/教学策略'>教学策略 (3)</a></li><li><a href='/blog/categories/教学设计'>教学设计 (3)</a></li><li><a href='/blog/categories/教师教育'>教师教育 (1)</a></li><li><a href='/blog/categories/日志'>日志 (14)</a></li><li><a href='/blog/categories/机器学习'>机器学习 (1)</a></li><li><a href='/blog/categories/汇总'>汇总 (2)</a></li><li><a href='/blog/categories/环境教育'>环境教育 (2)</a></li><li><a href='/blog/categories/生活'>生活 (11)</a></li><li><a href='/blog/categories/电影'>电影 (1)</a></li><li><a href='/blog/categories/社会观察'>社会观察 (12)</a></li><li><a href='/blog/categories/科学话剧'>科学话剧 (1)</a></li><li><a href='/blog/categories/科普'>科普 (2)</a></li><li><a href='/blog/categories/科研'>科研 (10)</a></li><li><a href='/blog/categories/笔记'>笔记 (1)</a></li><li><a href='/blog/categories/经济学'>经济学 (1)</a></li><li><a href='/blog/categories/统计'>统计 (6)</a></li><li><a href='/blog/categories/编程'>编程 (1)</a></li><li><a href='/blog/categories/设计'>设计 (7)</a></li><li><a href='/blog/categories/诗词曲'>诗词曲 (8)</a></li><li><a href='/blog/categories/课程'>课程 (3)</a></li><li><a href='/blog/categories/资源'>资源 (6)</a></li><li><a href='/blog/categories/随笔'>随笔 (6)</a></li><li><a href='/blog/categories/项目'>项目 (1)</a></li></ul>
</section>
<section>
  <h1>Tag Cloud</h1>
  <ul class="tag-cloud">
<a style="font-size: 103%" href="/tag/cse/">CSE</a>
<a style="font-size: 90%" href="/tag/gae/">GAE</a>
<a style="font-size: 98%" href="/tag/irt/">IRT</a>
<a style="font-size: 90%" href="/tag/le/">LE</a>
<a style="font-size: 90%" href="/tag/mbl/">MBL</a>
<a style="font-size: 98%" href="/tag/narst/">NARST</a>
<a style="font-size: 90%" href="/tag/ocw/">OCW</a>
<a style="font-size: 103%" href="/tag/pck/">PCK</a>
<a style="font-size: 98%" href="/tag/r/">R</a>
<a style="font-size: 98%" href="/tag/spss/">SPSS</a>
<a style="font-size: 90%" href="/tag/ted/">TED</a>
<a style="font-size: 90%" href="/tag/tpck/">TPCK</a>
<a style="font-size: 113%" href="/tag/ubc/">UBC</a>
<a style="font-size: 139%" href="/tag/uga/">UGA</a>
<a style="font-size: 113%" href="/tag/ubuntu/">Ubuntu</a>
<a style="font-size: 90%" href="/tag/bioteahouse/">bioteahouse</a>
<a style="font-size: 90%" href="/tag/code/">code</a>
<a style="font-size: 90%" href="/tag/course/">course</a>
<a style="font-size: 90%" href="/tag/curriculum/">curriculum</a>
<a style="font-size: 110%" href="/tag/design/">design</a>
<a style="font-size: 107%" href="/tag/diary/">diary</a>
<a style="font-size: 90%" href="/tag/django/">django</a>
<a style="font-size: 90%" href="/tag/ecojustice/">ecojustice</a>
<a style="font-size: 90%" href="/tag/effective-teaching/">effective teaching</a>
<a style="font-size: 165%" href="/tag/en/">en</a>
<a style="font-size: 90%" href="/tag/esci/">esci</a>
<a style="font-size: 90%" href="/tag/film/">film</a>
<a style="font-size: 103%" href="/tag/flash/">flash</a>
<a style="font-size: 98%" href="/tag/github/">github</a>
<a style="font-size: 98%" href="/tag/inquiry/">inquiry</a>
<a style="font-size: 90%" href="/tag/letter/">letter</a>
<a style="font-size: 103%" href="/tag/list/">list</a>
<a style="font-size: 107%" href="/tag/log/">log</a>
<a style="font-size: 90%" href="/tag/machine-learning/">machine learning</a>
<a style="font-size: 107%" href="/tag/metaphor/">metaphor</a>
<a style="font-size: 110%" href="/tag/modeling/">modeling</a>
<a style="font-size: 90%" href="/tag/msci/">msci</a>
<a style="font-size: 90%" href="/tag/network-analysis/">network analysis</a>
<a style="font-size: 103%" href="/tag/notes/">notes</a>
<a style="font-size: 90%" href="/tag/observation/">observation</a>
<a style="font-size: 107%" href="/tag/octopress/">octopress</a>
<a style="font-size: 90%" href="/tag/os/">os</a>
<a style="font-size: 90%" href="/tag/patent/">patent</a>
<a style="font-size: 98%" href="/tag/pck/">pck</a>
<a style="font-size: 90%" href="/tag/prezi/">prezi</a>
<a style="font-size: 90%" href="/tag/python/">python</a>
<a style="font-size: 90%" href="/tag/repeated-measures/">repeated measures</a>
<a style="font-size: 90%" href="/tag/resources/">resources</a>
<a style="font-size: 90%" href="/tag/stanford/">stanford</a>
<a style="font-size: 90%" href="/tag/story/">story</a>
<a style="font-size: 90%" href="/tag/strategy/">strategy</a>
<a style="font-size: 110%" href="/tag/supervision/">supervision</a>
<a style="font-size: 98%" href="/tag/teacher-knowledge/">teacher knowledge</a>
<a style="font-size: 90%" href="/tag/writing/">writing</a>
<a style="font-size: 107%" href="/tag/实验教学/">实验教学</a>
<a style="font-size: 90%" href="/tag/教学/">教学</a>
<a style="font-size: 98%" href="/tag/教学反思/">教学反思</a>
<a style="font-size: 98%" href="/tag/教学技能/">教学技能</a>
<a style="font-size: 98%" href="/tag/教学设计/">教学设计</a>
<a style="font-size: 90%" href="/tag/教学资源/">教学资源</a>
<a style="font-size: 90%" href="/tag/教案/">教案</a>
<a style="font-size: 90%" href="/tag/正能量/">正能量</a>
<a style="font-size: 98%" href="/tag/诗词/">诗词</a>
<a style="font-size: 90%" href="/tag/课程/">课程</a>
<a style="font-size: 90%" href="/tag/随笔/">随笔</a>

  </ul>
</section><section>
	<h1>最新评论</h1>
	<script type="text/javascript" src="http://chunlei.disqus.com/recent_comments_widget.js?num_items=5&hide_avatars=0&avatar_size=32&excerpt_length=200"></script>
</section><section>
<h1>Halley&#8217;s Comet</h1>
<script type="text/javascript" language="javascript">
//<![CDATA[
function thenceThen(timespan){
 var date1=new Date(timespan);
 var totalSecs=(date1-new Date())/1000;
 var days=Math.floor(totalSecs/3600/24);
 var hours=Math.floor((totalSecs-days*24*3600)/3600);
 var mins=Math.floor((totalSecs-days*24*3600-hours*3600)/60);
 var secs=Math.floor((totalSecs-days*24*3600-hours*3600-mins*60));
 document.getElementById("thenceThen").innerText=days+" days "+hours+" hours "+mins+" minutes "+secs+" seconds left.";
}
var clock;
window.onload=function(){
 clock=self.setInterval("thenceThen('2061/07/28')", 500);
}
//]]>
</script>
<div id="thenceThen"></div>
</section><section>
  <h1>Links</h1>
  <li><a href="http://bioteahouse.wikispaces.com/">Bioteahouse</a></li>
  <li><a href="http://wowubuntu.com/markdown/">MarkDown Syntax</a></li>
</section><section>
  <h1>Visitors to this Blog</h1>
    <div id="clustrmaps-widget"></div>
	  <script type="text/javascript">var _clustrmaps = {'url' : 'http://zhangchunlei.com/', 'user' : 1092323, 'server' : '2', 'id' : 'clustrmaps-widget', 'version' : 1, 'date' : '2013-09-14', 'lang' : 'en', 'corners' : 'square' };(function (){ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'http://www2.clustrmaps.com/counter/map.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);})();</script>
	  <noscript><a href="http://www2.clustrmaps.com/user/d1910aae3"><img src="http://www2.clustrmaps.com/stats/maps-no_clusters/zhangchunlei.com--thumb.jpg" alt="Locations of visitors to this page" /></a></noscript>

</section><section>
  <h1>Creative Commons</h1>
  <p>
   <img class="center" alt="License" src="https://raw.github.com/lukezhg/Freyja/master/CC.png"/>
   共享协议：本站所有作品采用<a href="http://creativecommons.org/licenses/by-nc-sa/2.5/cn/">知识共享署名-非商业性使用-相同方式共享 2.5 中国大陆许可协议</a>进行许可。
  </p>
  <p>Creative Commons — <a href="http://creativecommons.org/licenses/by-nc-sa/2.5/">Attribution-NonCommercial-ShareAlike 2.5 Generic — CC BY-NC-SA 2.5]</a></p>
</section>
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - chunlei -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'chunlei';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
